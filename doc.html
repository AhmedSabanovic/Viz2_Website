<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Code Documentation - WordStream-Extension</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      line-height: 1.6;
      margin: 0;
      padding: 0;
      background-color: #f4f4f4;
    }
    header {
      background: #333;
      color: #fff;
      padding: 1rem 0;
      text-align: center;
    }
    header h1 {
      margin: 0;
    }
    .container {
      max-width: 800px;
      margin: 2rem auto;
      padding: 1rem;
      background: #fff;
      border-radius: 8px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    }
    h2, h3, h4 {
      color: #333;
    }
    ul {
      list-style-type: disc;
      margin-left: 20px;
    }
    code {
      background: #f4f4f4;
      padding: 2px 4px;
      border-radius: 4px;
    }
  </style>
</head>
<body>
  <header>
    <h1>Code Documentation</h1>
  </header>
  <div class="container">
    <section id="code-documentation">
      <h2>Code Documentation</h2>
      <p>This section provides an overview of the key classes and functions implemented in the <strong>WordStream-Extension</strong> project. The documentation covers the primary files essential for the extension, including their roles and functionalities.</p>
      
      <h3>sentiment.html</h3>

      <h4>Libraries & Frameworks</h4>
      <ul>
        <li><code>D3.js (v7)</code>: For dynamic visualizations like the wordstream.</li>
        <li><code>D3 Cloud</code>: Used to generate word clouds.</li>
        <li><code>jQuery</code>: For DOM manipulation and UI management.</li>
        <li><code>noUiSlider</code>: Controls sentiment threshold sliders.</li>
        <li><code>Custom CSS</code>: Provides styling for the layout, wordstream, sliders, and UI.</li>
      </ul>
      
      <h4>HTML Structure</h4>
      <ul>
        <li><code>.title</code>: Contains page navigation links.</li>
        <li><code>#datasetSelector</code>: Dropdown for selecting the sentiment dataset.</li>
        <li><code>#positiveThreshold</code> & <code>#negativeThreshold</code>: Sliders for adjusting sentiment thresholds.</li>
        <li><code>#wordstream</code>: Visualization container for the wordstream.</li>
        <li><code>#modalBackdrop</code> & <code>#detailModal</code>: Modal elements for detailed view.</li>
      </ul>
      
      <h4>JavaScript Functionality</h4>
      <ul>
        <li><code>D3.js</code>: Dynamically generates the wordstream visualization.</li>
        <li><code>noUiSlider</code>: Manages sentiment threshold adjustments.</li>
        <li><code>smain.js</code>: Initializes and updates visualizations based on user input.</li>
        <li><code>jQuery</code>: Handles UI interactions (e.g., opening modals, updating UI elements).</li>
      </ul>
      
      <h4>Key Features</h4>
      <ul>
        <li><code>Dataset Selection</code>: Dropdown to select sentiment datasets.</li>
        <li><code>Threshold Sliders</code>: Adjusts positive and negative sentiment filters.</li>
        <li><code>Wordstream Visualization</code>: Displays sentiment analysis in word cloud form.</li>
        <li><code>Detailed Modal View</code>: Provides in-depth visualizations in a modal.</li>
        <li><code>Loading State</code>: Displays a spinner while processing data.</li>
      </ul>
      
      <h4>File Dependencies</h4>
      <ul>
        <li><code>jquery-ui.css</code>, <code>dd.css</code>, <code>d3.slider.css</code>, <code>main.css</code>, <code>wstyles.css</code>, <code>sstyles.css</code>: Styles for UI components and visualizations.</li>
        <li><code>jquery-1.9.0.min.js</code>, <code>jquery-ui.min.js</code>, <code>nouislider.min.js</code>: Libraries for UI controls and sliders.</li>
        <li><code>smain.js</code>: Custom JS for sentiment analysis logic.</li>
      </ul>
      
      <h3>smain.js</h3>
      
      <h4>Variables</h4>
      <ul>
        <li><code>selectedCategories</code>: Array of selected categories for word filtering (e.g., 'location', 'person').</li>
        <li><code>margin</code>, <code>width</code>, <code>height</code>: Layout settings for chart visualization.</li>
        <li><code>words</code>: Array of words to display in the visualization.</li>
      </ul>
      
      <h4>Functions</h4>
      <ul>
        <li><code>loadData(dataset)</code>: Loads and processes the sentiment dataset.</li>
        <li><code>showDetail(wordText)</code>: Displays a modal with detailed sentiment analysis for a word.</li>
        <li><code>updateVisualization()</code>: Updates the word cloud based on selected categories and thresholds.</li>
        <li><code>createTimeline(years)</code>: Visualizes word trends over time.</li>
      </ul>
      
      <h4>Classes & IDs</h4>
      <ul>
        <li><code>#detailModal</code>, <code>#modalBackdrop</code>, <code>.loading-spinner</code>, <code>#wordstream</code>, <code>#detailChart</code>: UI elements for modals, loading states, and visualization containers.</li>
        <li><code>.tooltip</code>, <code>.word</code>, <code>.year-marker</code>: For visual interactivity and markers.</li>
      </ul>
      
      <h4>Interactive Elements</h4>
      <ul>
        <li><code>positiveThreshold</code>: Slider for adjusting the positive sentiment threshold.</li>
        <li><code>negativeThreshold</code>: Slider for adjusting the negative sentiment threshold.</li>
        <li><code>#categorySelector</code>: Dropdown for selecting categories to filter the word cloud.</li>
        <li><code>#datasetSelector</code>: Dropdown for selecting the dataset to load.</li>
      </ul>
      
      <h4>Event Listeners</h4>
      <ul>
        <li><code>noUiSlider</code> on <code>positiveThreshold</code>: Updates the visualization based on the selected positive sentiment threshold.</li>
        <li><code>noUiSlider</code> on <code>negativeThreshold</code>: Updates the visualization based on the selected negative sentiment threshold.</li>
        <li><code>#categorySelector</code>: Triggers the update of the word cloud when categories are changed.</li>
        <li><code>#datasetSelector</code>: Triggers the loading of a new dataset when the selection changes.</li>
      </ul>
      
      <h3>sstyles.css</h3>
      <ul>
        <li><code>noUi-handle</code>: Customizes slider handle appearance.</li>
        <li><code>title</code>: Styles the page title.</li>
        <li><code>container</code>, <code>sidebar</code>: Layout and positioning of main content and sidebar.</li>
        <li><code>visualization</code>: Styles for the wordstream and visualization area.</li>
        <li><code>controls</code>: Controls styling for sticky top bar.</li>
        <li><code>modal-related</code>: Styles for modals (e.g., backdrop, close button, content).</li>
        <li><code>loading-spinner</code>: Appearance and positioning of the loading spinner.</li>
        <li><code>wordstream</code>, <code>timeline</code>: Adjusts layout and visual effects for the word cloud and timeline.</li>
      </ul>
      
      <h3>Wordcloud sentiment.html</h3>
      <p>The <em>Wordcloud sentiment.html</em> file provides the structure and layout for the Sentiment Cloud visualization within the WordStream-Extension project. It includes the necessary HTML elements, external libraries, and custom scripts to render and interact with the sentiment word cloud.</p>

      <!-- <h4>Key Elements</h4> -->
      <ul>
        <li><code>&lt;div class="title"&gt;</code>: Navigation bar with links to different sections of the WordStream application.</li>
        <li><code>&lt;div class="container"&gt;</code>: Main container that holds the sidebar and visualization sections.</li>
        <li><code>&lt;div class="sidebar"&gt;</code>: Sidebar containing control elements for dataset selection, category filtering, and threshold adjustments.</li>
        <li><code>&lt;div class="visualization"&gt;</code>: Container for the word cloud visualization and legend.</li>
        <li><code>&lt;div id="wordcloud" class="wordcloud"&gt;</code>: Element where the word cloud is rendered.</li>
        <li><code>&lt;div id="yearSlider" class="slider"&gt;</code>: Slider for selecting the year range.</li>
        <li><code>&lt;div id="positiveThreshold" class="slider"&gt;</code>: Slider for adjusting the positive sentiment threshold.</li>
        <li><code>&lt;div id="negativeThreshold" class="slider"&gt;</code>: Slider for adjusting the negative sentiment threshold.</li>
      </ul>

      <!-- <h4>External Libraries</h4> -->
      <ul>
        <li><code>d3.v7.min.js</code>: D3.js library for creating data-driven visualizations.</li>
        <li><code>d3-scale-chromatic.v1.min.js</code>: D3.js module for color scales.</li>
        <li><code>d3.layout.cloud.min.js</code>: D3.js layout for word clouds.</li>
        <li><code>jquery-1.9.0.min.js</code>: jQuery library for DOM manipulation.</li>
        <li><code>jquery-ui.min.js</code>: jQuery UI for interactive elements.</li>
        <li><code>nouislider.min.js</code>: noUiSlider library for creating sliders.</li>
      </ul>

      <!-- <h4>Custom Scripts and Styles</h4> -->
      <ul>
        <li><code>wmain.js</code>: Custom JavaScript for handling the functionality and interactivity of the Sentiment Cloud visualization.</li>
        <li><code>wstyles.css</code>: Custom CSS for styling the Sentiment Cloud visualization and its components.</li>
      </ul>
      
      <h3>Wmain.js</h3>
      <p>The <em>Wmain.js</em> script manages the functionality and interactivity of the Sentiment Cloud visualization within the WordStream-Extension project. It handles data loading, filtering, and rendering of the word cloud based on sentiment analysis.</p>

      <!-- <h4>Global Variables</h4> -->
      <ul>
        <li><code>words</code>: Array to store processed word data.</li>
        <li><code>width</code> and <code>height</code>: Dimensions of the visualization canvas.</li>
        <li><code>minFontSize</code> and <code>maxFontSize</code>: Font size range for words in the word cloud.</li>
        <li><code>yearRange</code>: Object to store the minimum and maximum years in the dataset.</li>
        <li><code>selectedCategories</code>: Array of categories selected for filtering words.</li>
      </ul>

      <!-- <h4>Color Scale</h4> -->
      <ul>
        <li><code>colorScale</code>: D3 sequential color scale for mapping sentiment scores to colors.</li>
      </ul>

      <!-- <h4>Word Cloud Layouts</h4> -->
      <ul>
        <li><code>layoutPositive</code>: D3 layout for the positive sentiment word cloud.</li>
        <li><code>layoutNegative</code>: D3 layout for the negative sentiment word cloud.</li>
      </ul>

      <!-- <h4>Draw Functions</h4> -->
      <ul>
        <li><code>drawPositive(words)</code>: Renders the positive sentiment word cloud.</li>
        <li><code>drawNegative(words)</code>: Renders the negative sentiment word cloud.</li>
      </ul>

      <!-- <h4>Slider Initialization</h4> -->
      <ul>
        <li><code>initializeSliders()</code>: Initializes the year, positive threshold, and negative threshold sliders using noUiSlider.</li>
      </ul>

      <!-- <h4>Filter Update</h4> -->
      <ul>
        <li><code>updateFilters()</code>: Filters words based on selected year and sentiment thresholds, then updates the word clouds.</li>
      </ul>

      <!-- <h4>Data Loading and Processing</h4> -->
      <ul>
        <li><code>loadData(dataset)</code>: Loads and processes the selected dataset, updating the word cloud and category selector.</li>
      </ul>

      <!-- <h4>Category Selector Update</h4> -->
      <ul>
        <li><code>updateCategorySelector(categories)</code>: Updates the category selector dropdown based on available categories in the dataset.</li>
      </ul>

      <!-- <h4>Initialization</h4> -->
      <ul>
        <li><code>init()</code>: Initializes the visualization, sets up event listeners, and loads the initial dataset.</li>
      </ul>

      <!-- <h4>Event Listeners</h4>
      <ul>
        <li>Event listeners for sliders and dropdowns to handle user interactions and update the visualization accordingly.</li>
      </ul>

      <h4>DOM Content Loaded</h4>
      <ul>
        <li>Starts the visualization initialization when the DOM content is fully loaded.</li>
      </ul> -->
      
      <h3>wstyles.css</h3>
      <p>The <em>wstyles.css</em> file provides the styling for the Sentiment Cloud visualization within the WordStream-Extension project. It ensures a cohesive and visually appealing user interface by defining styles for various elements and components.</p>

      <!-- <h4>Key Classes and Selectors</h4> -->
      <ul>
        <li><code>.container</code>: Styles the main container, using flexbox for layout and spacing.</li>
        <li><code>.sidebar</code>: Styles the sidebar, including padding, background color, border, and height.</li>
        <li><code>.control-group</code>: Styles control groups within the sidebar, including layout, margin, and padding.</li>
        <li><code>#datasetSelector, #categorySelector</code>: Styles the dataset and category dropdown selectors.</li>
        <li><code>.slider</code>: Styles the sliders for year and sentiment thresholds.</li>
        <li><code>.noUi-target, .noUi-horizontal, .noUi-connect, .noUi-handle, .noUi-tooltip</code>: Styles for the noUiSlider components, including track, handle, and tooltips.</li>
        <li><code>.visualization</code>: Styles the visualization container, ensuring it flexes to fill available space.</li>
        <li><code>.wordcloud</code>: Styles the word cloud container, including dimensions, border, and position.</li>
        <li><code>.word</code>: Styles individual words in the word cloud, including cursor and hover effects.</li>
        <li><code>.title</code>: Styles the title bar, including padding.</li>
        <li><code>.button</code>: Styles navigation buttons, including padding, margin, border, and active state.</li>
        <li><code>.legend</code>: Styles the legend container, including layout, background, border, and shadow.</li>
        <li><code>.legend div</code>: Styles individual legend items, including dimensions, text alignment, and background colors for positive and negative sentiments.</li>
        <li><code>.middle-line</code>: Styles the middle line in the word cloud, indicating separation between positive and negative sentiments.</li>
      </ul>
      
      <h3>Data Folder</h3>
      <p>The <code>/data</code> folder contains all datasets used for the WordStream-Extension, along with scripts for preprocessing the data.</p>
      
      <!-- <h4>Preprocess Folder</h4> -->
      <p>The <code>/data/preprocess</code> directory includes Python scripts responsible for cleaning, processing, and preparing raw data for visualization. Each script contains the name of the dataset it preprocesses, the original datasets can be found in <code>/data/raw.</code> </p>
      
      <p>We integrated three new datasets into WordStream: Rotten Tomatoes movie reviews, CNN news articles, and Reddit posts from the /datasets subreddit. The preprocessing pipeline for these datasets included:</p>
      <ul>
        <li><strong>Data Collection:</strong> Acquired datasets from trusted sources, ensuring a diverse range of text corpora.</li>
        <li><strong>Data Cleaning:</strong> Performed text normalization, including lowercasing, removal of special characters, and handling of missing values to ensure consistency across datasets. For this we used <a href="https://pandas.pydata.org/" target="_blank">Pandas</a>. </li>
        <li><strong>Keyword Extraction:</strong> Utilized the <a href="https://spacy.io/" target="_blank">SpaCy</a> library in Python to extract relevant keywords from each dataset, enhancing the quality of the visualization.</li>
        <li><strong>Sentiment Analysis:</strong> Applied the <a href="https://github.com/cjhutto/vaderSentiment" target="_blank">VADER Sentiment Analyzer</a> to compute sentiment scores for each text entry, categorizing sentiments as positive, neutral, or negative.</li>
        <li><strong>Additional data Transformation:</strong> Necessary to visualize the data in the new visualization we built. The data was aggregated data by year, calculating the average sentiment per text and the frequency of each keyword annually to facilitate temporal analysis.</li>
      </ul>
      <p>Other datasets containing data such as social media posts and fact-check articles were added. However, due to reasons that we were not able to understand, these datasets proved to be difficult to visualize in the WordStream. In order not to waste the effort invested in these datasets, they are only visualizible in the SentimentCloud and SentimentStream tabs.</p>
      
    </section>
  </div>
</body>
</html>
